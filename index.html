<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knitting Progress Tracker</title>
    <style>
        :root {
            --pastel-pink-bg: #FCE4EC;
            --soft-pink-card: #FFF1F1;
            --hot-pink-accent: #F06292;
            --deep-pink-text: #880E4F;
            --nav-blue-pastel: #90CAF9;
            --inc-color: #C2185B;
            --dec-color: #1565C0;
            --neut-color: #4A148C;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--pastel-pink-bg);
            color: var(--deep-pink-text);
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        .container {
            background: white;
            width: 100%;
            max-width: 500px;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            text-align: center;
        }

        /* Menu Styles */
        .menu-screen { display: block; }
        .tracker-screen { display: none; }

        .menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .menu-btn {
            background: var(--soft-pink-card);
            border: 2px solid var(--hot-pink-accent);
            padding: 20px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            color: var(--deep-pink-text);
            transition: all 0.2s;
            font-size: 1rem;
        }

        .menu-btn:hover {
            background: var(--hot-pink-accent);
            color: white;
        }

        /* Tracker Styles */
        .size-selector { margin-bottom: 15px; }

        .card {
            background-color: var(--soft-pink-card);
            padding: 20px;
            border-radius: 15px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .progress-subtext {
            font-style: italic;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .shaping-section {
            margin-bottom: 20px;
            display: none;
        }

        progress {
            width: 100%;
            height: 20px;
            accent-color: var(--hot-pink-accent);
        }

        .reminder {
            font-weight: bold;
            font-size: 1.2rem;
            min-height: 60px;
            margin: 15px 0;
            white-space: pre-wrap;
        }

        .row-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .btn {
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: opacity 0.2s;
        }

        .btn:disabled { opacity: 0.3; cursor: not-allowed; }
        .btn-row { background-color: #F8BBD0; color: var(--deep-pink-text); font-size: 1.2rem; }
        .btn-nav { background-color: var(--nav-blue-pastel); color: white; flex: 1; }
        .btn-prev { background-color: #e0e0e0; color: #666; }
        .btn-reset { background-color: #FFCDD2; color: var(--deep-pink-text); font-size: 0.8rem; }

        .nav-group { display: flex; gap: 10px; margin-top: 10px; }

        .abbr-box {
            text-align: left;
            font-size: 0.85rem;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            white-space: pre-wrap;
        }

        canvas {
            position: fixed;
            top: 0; left: 0;
            pointer-events: none;
            z-index: 99;
        }
    </style>
</head>
<body>

<canvas id="confetti"></canvas>

<div class="container">
    <div id="menu-screen" class="menu-screen">
        <h1 style="color: var(--hot-pink-accent);">Knitting Tracker</h1>
        <p>Select a project to begin:</p>
        <div class="menu-grid">
            <button class="menu-btn" onclick="startProject('hood')">Sophie Hood</button>
            <button class="menu-btn" onclick="startProject('scarf')">Sophie Scarf</button>
            <button class="menu-btn" onclick="startProject('beanie')">Classic Beanie</button>
            <button class="menu-btn" onclick="startProject('balaclava')">Balaclava</button>
        </div>
    </div>

    <div id="tracker-screen" class="tracker-screen">
        <h2 id="project-title">Project Guide</h2>

        <div class="size-selector">
            <label>Size: </label>
            <input type="radio" name="size" value="0" checked onchange="updateSize(0)"> S
            <input type="radio" name="size" value="1" onchange="updateSize(1)"> M
            <input type="radio" name="size" value="2" onchange="updateSize(2)"> L
        </div>

        <div class="card" id="step-text"></div>
        <div class="progress-subtext" id="step-count"></div>

        <div id="shaping-area" class="shaping-section">
            <div id="shaping-label"></div>
            <progress id="shaping-bar" value="0" max="100"></progress>
        </div>

        <div class="reminder" id="reminder-text"></div>

        <div class="row-controls">
            <button class="btn btn-row" onclick="changeRow(1)">+ Row</button>
            <div style="font-size: 1.5rem; font-weight: bold;" id="row-display">Rows: 0</div>
            <button class="btn btn-row" onclick="changeRow(-1)">- Row</button>
            <button class="btn btn-reset" onclick="resetCounter()">ðŸ”„</button>
        </div>

        <div class="nav-group">
            <button class="btn btn-nav btn-prev" id="prev-btn" onclick="prevStep()">â¬… Previous</button>
            <button class="btn btn-nav" id="next-btn" onclick="nextStep()">Next âž¡</button>
        </div>
        
        <button class="btn btn-reset" style="margin-top:15px; width:100%" onclick="goToMenu()">Exit to Menu</button>

        <div class="abbr-box" id="abbr-content">
<strong>ABBREVIATIONS</strong>
k: knit | p: purl | RS: right side | WS: wrong side
        </div>
    </div>
</div>

<script>
    // Pattern Data logic
    const patterns = {
        hood: {
            title: "Sophie Hood Guide",
            steps: [
                "Welcome to the Sophie Hood ðŸ§¶\n\nSize S (M) L\nGauge: 17 sts = 10cm",
                "Cast on 6 stitches.\nWork i-cord edge for 6 rows.",
                "Scarf Section (Increases)\nWork increases every 6th (8th) 10th row until 45 sts.",
                "Right Hood Body\nWork back and forth for 16 garter ridges.",
                "Hood Shaping: Decreases\nDecrease every 4th, 2nd, and then every row.",
                "Hood Shaping: Increases\nIncrease every row, then 2nd, then 4th row.",
                "Left Hood Body\nWork 17 garter ridges back and forth.",
                "Rejoin Scarf & Bind Off\nComplete the second tail and bind off.",
                "Finished ðŸŽ‰"
            ],
            shaping: {
                2: { label: "Scarf Increases", total: 200 },
                3: { label: "Right Hood Ridges", total: 32 },
                7: { label: "Tail Decreases", total: 200 }
            }
        },
        scarf: {
            title: "Sophie Scarf Guide",
            steps: [
                "Welcome to the Sophie Scarf ðŸ§£\n\nWork from tip to tip.",
                "Cast on 6 stitches.",
                "Increasing Section\nIncrease every 8th row until desired width.",
                "Middle Section\nWork straight until length is almost finished.",
                "Decreasing Section\nDecrease every 8th row until 6 sts remain.",
                "Bind off and weave in ends.",
                "Finished ðŸŽ‰"
            ],
            shaping: {
                2: { label: "Increasing", total: 100 },
                4: { label: "Decreasing", total: 100 }
            }
        },
        beanie: {
            title: "Classic Beanie Guide",
            steps: [
                "Cast on for Beanie ðŸ§¢\n(S: 80, M: 88, L: 96 sts)",
                "Work 1x1 Ribbing (K1, P1) for 5-8 cm.",
                "Work in Stockinette Stitch (Knit all rounds) until total length is 18-22 cm.",
                "Decrease Rounds\nK2tog across every other row until 8 sts remain.",
                "Cut yarn and pull through remaining stitches.",
                "Finished ðŸŽ‰"
            ],
            shaping: {
                2: { label: "Body Length", total: 60 },
                3: { label: "Crown Decreases", total: 10 }
            }
        },
        balaclava: {
            title: "Balaclava Guide",
            steps: [
                "Cast on for Balaclava ðŸ¥·\nStarting from the top down.",
                "Work top rectangle shaping.",
                "Pick up stitches and work the hood section.",
                "Face Opening\nCast off stitches for face, then cast back on in next row.",
                "Neck Section\nWork in the round (K2, P2 ribbing).",
                "Bind off loosely.",
                "Finished ðŸŽ‰"
            ],
            shaping: {
                2: { label: "Hood Length", total: 50 },
                4: { label: "Neck Ribbing", total: 30 }
            }
        }
    };

    let currentPattern = null;
    let state = JSON.parse(localStorage.getItem('knittingState')) || { project: null, step: 0, rows: 0, size: 0 };

    function startProject(type) {
        state.project = type;
        state.step = 0;
        state.rows = 0;
        loadProject();
    }

    function loadProject() {
        if (!state.project) return;
        currentPattern = patterns[state.project];
        
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('tracker-screen').style.display = 'block';
        document.getElementById('project-title').innerText = currentPattern.title;
        
        updateDisplay();
    }

    function goToMenu() {
        if(confirm("Exit to menu? Progress is saved.")) {
            document.getElementById('menu-screen').style.display = 'block';
            document.getElementById('tracker-screen').style.display = 'none';
        }
    }

    function updateDisplay() {
        if (!currentPattern) return;
        
        const steps = currentPattern.steps;
        document.getElementById('step-text').innerHTML = steps[state.step].replace(/\n/g, "<br>");
        document.getElementById('step-count').innerText = `Step ${state.step + 1} of ${steps.length}`;
        document.getElementById('row-display').innerText = `Rows: ${state.rows}`;
        
        document.getElementById('prev-btn').disabled = state.step === 0;
        document.getElementById('next-btn').disabled = state.step === steps.length - 1;

        const shaping = currentPattern.shaping[state.step];
        const area = document.getElementById('shaping-area');
        if (shaping) {
            area.style.display = 'block';
            document.getElementById('shaping-label').innerText = shaping.label;
            document.getElementById('shaping-bar').max = shaping.total;
            document.getElementById('shaping-bar').value = state.rows;
        } else {
            area.style.display = 'none';
        }

        localStorage.setItem('knittingState', JSON.stringify(state));
        if(state.step === steps.length - 1) triggerConfetti();
    }

    function changeRow(val) {
        state.rows = Math.max(0, state.rows + val);
        updateDisplay();
    }

    function nextStep() { state.step++; state.rows = 0; updateDisplay(); }
    function prevStep() { state.step--; state.rows = 0; updateDisplay(); }
    function resetCounter() { state.rows = 0; updateDisplay(); }
    function updateSize(s) { state.size = s; updateDisplay(); }

    function triggerConfetti() {
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];
        for(let i=0; i<30; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 8 + 4,
                speed: Math.random() * 3 + 2,
                color: ['#F06292', '#90CAF9', '#FF80AB'][Math.floor(Math.random()*3)]
            });
        }
        function draw() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            particles.forEach(p => {
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                ctx.fill();
                p.y += p.speed;
            });
            if(particles.length > 0 && particles[0].y < canvas.height) requestAnimationFrame(draw);
        }
        draw();
    }

    // Auto-load if project exists
    if (state.project) loadProject();
</script>

</body>
</html>
